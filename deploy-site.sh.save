#!/bin/bash

if [ -z "$1" ]
then
  echo "Please provide a commit message"
  exit 1
fi

# ---> BUILD SITE <---
#update deployment repository
cd segment-routing/public
git pull

# delete everything in deployment repoitory, except .git and CNAME
shopt -s extglob
rm -rf !('.git/*'|'CNAME'|'README.md')

#build site
cd ..
hugo

# ---> DEPLOY SITE <---
cd public
git add .
git commit -m "$1"
git push
